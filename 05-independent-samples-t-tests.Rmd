# Independent Samples T-Test {#istt}

Like the One Sample T-Test, we will go through:
- Getting descriptive statistics
- Check assumptions
- Perform the t-test

We will also be using a data set more appropriate to an Independent samples t-test, the sleep data set.  This data is looking at the effect of two different soporific (sleep) drugs and if they increase or decrease the amount of sleep students get compared to control.  We have three variables: extra (increase in hours of sleep), group (which drug was given), and ID (patient ID). 

```{r ostt data, include = TRUE, eval = TRUE}
#Assign data set to an object
df <- sleep

#See what it looks like
head(df)
```

## Descriptives

Since we have two groups we are comparing, and we'd like a bit more information than provided by `summary()`, we will use the `describeBy()` function in the psych package.  This function takes the form $$describeBy(x, group = groupingvar)$$ and gives basic summary statistics by group. 
```{r istt descriptives, include = TRUE, eval = TRUE, warning = FALSE}
#Call the package
library(psych)

#Get the descriptives by group
describeBy(df$extra, group = df$group)
```

In our output, we see that we get two different sets of descriptive statistics, one for group = 1 (`group: 1`), and another for group = 2 (`group: 2`).  In each output, it tells us how many individuals (`n`), the mean and standard deviation (`mean` and `sd`, respectively), and the skew and kurtosis (`skew` and `kurtosis`) of each group, among other things.

A box plot can be helpful to identify if there are outliers in our groups.  We will make a boxplot, again using `ggplot2`.  In the code below, we are first defining our data (`data = df`) and x (`x = group`) and y (`y = extra`) values.  Our x value is our grouping variable, and our y value is the one we are comparing; in our case, how many extra hours of sleep.  The next line calls the boxplot function (`geom_boxplot()`), and the last one prints each data point as a dot on the box plot (`geom_jitter()`).  The last argument can be left blank, but it may be easier to compare your data points when they're not as spread out horizontally, so the `width = .2` argument squishes them together a bit.  The opposite is true with larger datasets - you may want them more spread out!  In which case, you can leave that argument blank.  

```{r istt box, include = TRUE, eval = TRUE, warning = FALSE, message = FALSE}
#Call ggplot
library(ggplot2)

#Generate a boxplot
ggplot(data = df, aes(x = group, y = extra)) + 
  geom_boxplot() +
  geom_jitter(width = .2)
```

## Check Assumptions
Since we have two groups, we have to test assumptions for each group, rather than on the data as a whole.  This involves a few extra lines of code to ask R to split by group, and we will make use of the 'pipe'(`%>%`) from the `tidyverse` package.  This symbol is basically saying "take this bit, and send it on to the next".  It can be very useful, and make code easier to read and write.

We start off by running a Shapiro-Wilk test to test for normality.  Recall from the one-sample t-test that we used the `shapiro.test()` function to get this information.  The output contained the W statistic, or Shaprio-Wilk statistic, and the p-value.  Had we assigned that to an object, we could see what information it contained, **and** what it called that information.  After running the code below, if we look in our Environment Window and click on the object "SW"
```{r ostt reminder, include = TRUE, eval = TRUE}
#SW test for trees
shapiro.test(trees$Height)

#Assign to an object
SW <- shapiro.test(trees$Height) 

```

After running the code above, if we look in our Environment Window and click on the object "SW", we can see that it is in fact made of four things: statistic, p.value, method, and data.name.  For our Independent Samples t-test, where we want this information by group, we will be calling on those individual items within the `shapiro.test()` output.

```{r, istt-SW, echo = FALSE, include = TRUE, fig.cap = "Behind the scenes of One Sample t-test shapiro.test() Function", fig.align = "center", fig.width = 6, fig.asp = 0.7}
knitr::include_graphics(rep("istt_SW.png"))
```


In the code below, we are first calling the `tidyverse` package (`library(tidyverse)`) before moving on to running the Shapiro-Wilk test.  Then, we specify our data (`df`) and send it on to the next line (`%>%`).  We specify which variable R should group by with the `group_by()` function - for us, it is the 'group' variable. [NOTE: this is a bit confusing, and your grouping variable should probably be named something else, like "treatment" or "drug".]  So, the line `group_by(group)` is taking our dataframe and now grouping it according to group membership.  Then, we send that on (`%>%`) to the Shapiro-Wilk test.  It looks different than before, becuse we are asking it to report out by group rather than just the whole dataset.  

We start with the `summarise()` function, and define what our columns will  be (our rows have alread been taken care of by `group_by()`).  The Shapiro-Wilk statistic is named "S-W Statistic", and we say that we'd like that value to be the statistic from the function: `"S-W Statistic" = shapiro.test(extra)$statistic`.  We see that we are still calling the `shapiro.test()` function on the 'extra' column (`shapiro.test(extra)`), but then we are including `$statistic` because that's the value we want in this column.  In the second column we'd like the p-value from the `shapiro.test()` function: `"p-value" = shapiro.test(extra)$p.value`
```{r ostt sw, include = TRUE, eval = TRUE}
#Call tidyverse package
library(tidyverse)

#Run the Shapiro-Wilk test
df %>%   #Call our dataframe and send it on
  group_by(group) %>%    #Group by our grouping variable
  summarise("S-W Statistic" = shapiro.test(extra)$statistic,   #Give us the statistics we want, in a table
            "p-value" = shapiro.test(extra)$p.value)
```


```{r istt hist, include = TRUE, eval = TRUE, warning = FALSE}
#Generate a histogram
ggplot(data = df, aes(x = extra)) +
  geom_histogram() +
  facet_grid(group ~ .)

#Both in the same plot - I don't think this is as clear, especially with these data
ggplot(data = df, aes(x = extra, fill = group)) +
  geom_histogram(position = "identity", alpha = 0.4)
```

## Perform the T-Test
